generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}
// ENUMS NEEDED FOR APPLICANTS FORM
enum Track {
  FRONTEND
  BACKEND
  FULLSTACK_DEVELOPMENT
  MOBILE_DEVELOPMENT
  DATA_SCIENCE
  MACHINE_LEARNING
  DATA_ANALYSIS
  DATA_ENGINEERING
  UI_DESIGN
  UX_DESIGN
  GRAPHICS_DESIGN
  UX_RESEARCH
  PRODUCT_MARKETING_MANAGEMENT
  OPERATIONS
  SALES
  BUSINESS_DEVELOPMENT
  PROJECT_PRODUCT_MANAGEMENT
}

enum ReferralSource {
  TWITTER
  LINKEDIN
  INSTAGRAM
  FACEBOOK
  FRIEND
  OTHER
}

enum FrontendTool {
  REACT
  VUE
  ANGULAR
  SVELTE
  OTHER
}

enum BackendTool {
  NODE
  EXPRESS
  DJANGO
  FASTAPI
  LARAVEL
  OTHER
}

enum MobileTool {
  FLUTTER
  REACT_NATIVE
  KOTLIN
  SWIFT
  OTHER
}

enum ApplicationStatus {
  PENDING
  REVIEWED
  SHORTLISTED
  ASSESSMENT_SENT
  ASSESSMENT_SUBMITTED
  INTERVIEW_SCHEDULED
  INTERVIEW_PASSED
  REJECTED
  ACCEPTED
}

// LOOKUP TABLES FOR ADMIN TO MAKE CHANGES IN THE FUTURE
model TrackOption {
  id        String   @id @default(uuid())
  name      String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model ReferralSourceOption {
  id        String   @id @default(uuid())
  name      String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model FrontendToolOption {
  id        String   @id @default(uuid())
  name      String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model BackendToolOption {
  id        String   @id @default(uuid())
  name      String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model MobileToolOption {
  id        String   @id @default(uuid())
  name      String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Role {
  id        String   @id @default(uuid())
  name      String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  users     UserRole[]
}

// CORE MODELS
model User {
  id          String        @id @default(uuid())
  email       String        @unique
  password    String
  firstName   String
  lastName    String
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt

  roles       UserRole[]
  admin       AdminProfile?
  mentor      MentorProfile?
  student     StudentProfile?
}

// APPLICANTS MODEL
model Application {
  id                     String         @id @default(uuid())
  firstname               String
  lastname                String
  email                   String         @unique

  phoneNumber            String         @unique
  city                   String

  track                  Track
  referralSource         ReferralSource
  frontendTools          FrontendTool[]  @default([])
  backendTools           BackendTool[]  @default([])
  mobileTools            MobileTool[]   @default([])

  frontendToolsOther  String[]  @default([])
  backendToolsOther String[]  @default([])
  mobileToolsOther String[]  @default([])
  referralSourceOther    String[]  @default([])


  status                 ApplicationStatus @default(PENDING)

  assessments            Assessment[]
  interviews             Interview[]

  createdAt              DateTime       @default(now())
  updatedAt              DateTime       @updatedAt
}



// MANY-TO-MANY: ROLES
model UserRole {
  userId   String
  roleId   String

  user     User   @relation(fields: [userId], references: [id])
  role     Role   @relation(fields: [roleId], references: [id])

  @@id([userId, roleId])
}

// ASSESSMENT & INTERVIEW â€“ One-to-Many
model Assessment {
  id              String      @id @default(uuid())
  applicationId   String
  application     Application @relation(fields: [applicationId], references: [id])

  assessmentLink  String?
  submissionLink  String?
  sentAt          DateTime?
  submittedAt     DateTime?
  reviewedAt      DateTime?

  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt
}

model Interview {
  id             String            @id @default(uuid())
  applicationId  String
  application    Application       @relation(fields: [applicationId], references: [id])

  status         ApplicationStatus  @default(SHORTLISTED)
  interviewDate  DateTime
  notes          String?

  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt
}

// PROFILES
model AdminProfile {
  id        String   @id @default(uuid())
  userId    String   @unique
  user      User     @relation(fields: [userId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model StudentProfile {
  id        String   @id @default(uuid())
  userId    String   @unique
  user      User     @relation(fields: [userId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model MentorProfile {
  id        String   @id @default(uuid())
  userId    String   @unique
  user      User     @relation(fields: [userId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}